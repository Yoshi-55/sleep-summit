<% content_for :page_title do %>
  <%= t('dashboard.index.page_title') %>
<% end %>

    <div class="flex flex-col lg:flex-row lg:items-start gap-3 sm:gap-4 lg:gap-6 mb-6 sm:mb-8">
      <!-- 左カラム -->
      <div class="w-full lg:w-auto lg:flex-[7_0_0%] flex flex-col gap-3 sm:gap-4 lg:gap-6">
        <!-- グラフ -->
        <%= render 'shared/card', class: 'min-w-0' do %>
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-2xl font-bold"><%= t('dashboard.index.activity_graph') %></h3>
            <span class="badge badge-outline"><%= t('dashboard.index.week') %></span>
          </div>
          <div id="sleep-chart"
            data-series='<%= @series.to_json.html_safe %>'
            class="h-[250px] sm:h-[300px] lg:h-[350px]">
          </div>
        <% end %>

        <!-- 記録カード（モバイル） -->
        <%= render 'shared/card', class: 'lg:hidden min-w-0' do %>
          <div class="space-y-3">
            <%= button_to I18n.t('dashboard.index.wake_record'), record_wake_sleep_records_path,
                method: :post,
                class: "btn btn-primary btn-lg w-full #{'btn-disabled' if @unwoken_record.present?}",
                disabled: @unwoken_record.present?,
                data: { test: 'mobile-wake-button' } %>
            <%= button_to I18n.t('dashboard.index.bed_record'),
                (@unwoken_record ? record_bed_sleep_record_path(@unwoken_record) : "#"),
                method: :patch,
                class: "btn btn-secondary btn-lg w-full #{'btn-disabled' if @unwoken_record.nil?}",
                disabled: @unwoken_record.nil?,
                data: { test: 'mobile-bed-button' } %>
          </div>
        <% end %>

        <!-- 記録テーブル -->
        <%= render 'shared/sleep_records_table',
            records: @weekly_records,
            title: t('dashboard.index.this_week_records') %>

        <!-- 統計 -->
        <%= render 'shared/sleep_stats_cards',
            average_wake_hours: @weekly_average_wake_hours,
            average_sleep_hours: @weekly_average_sleep_hours,
            average_wake_time: @weekly_average_wake_time,
            average_bed_time: @weekly_average_bed_time,
            average_wake_hours_label: t('dashboard.index.weekly_average_wake_hours'),
            average_sleep_hours_label: t('dashboard.index.weekly_average_sleep_hours'),
            average_wake_time_label: t('dashboard.index.weekly_average_wake_time'),
            average_bed_time_label: t('dashboard.index.weekly_average_bed_time') %>

      </div>

      <!-- 右カラム -->
      <div class="hidden lg:flex lg:flex-[3_0_0%] flex-col gap-3 sm:gap-4 lg:gap-6">

        <!-- 記録カード -->
        <%= render 'shared/card' do %>
          <div class="space-y-3">
            <%= button_to I18n.t('dashboard.index.wake_record'), record_wake_sleep_records_path,
                method: :post,
                class: "btn btn-primary btn-lg w-full #{'btn-disabled' if @unwoken_record.present?}",
                disabled: @unwoken_record.present?,
                data: { test: 'desktop-wake-button' } %>
            <%= button_to I18n.t('dashboard.index.bed_record'),
                (@unwoken_record ? record_bed_sleep_record_path(@unwoken_record) : "#"),
                method: :patch,
                class: "btn btn-secondary btn-lg w-full #{'btn-disabled' if @unwoken_record.nil?}",
                disabled: @unwoken_record.nil?,
                data: { test: 'desktop-bed-button' } %>
          </div>
        <% end %>

      </div>
    </div>
